# Scenario fixture for AWS CLI destructive operations.
# Schema: id, description, steps[{command, expected_pack, expected_decision, reason}]

id: "cloud.aws.destructive_ops"
description: "Operator performs safe AWS reads, then issues destructive deletes."
steps:
  - command: "aws sts get-caller-identity"
    expected_pack: "cloud.aws"
    expected_decision: "allow"
    reason: "Identity lookup is read-only"
  - command: "aws ec2 describe-instances"
    expected_pack: "cloud.aws"
    expected_decision: "allow"
    reason: "Describe instances is read-only"
  - command: "aws s3 ls s3://prod-bucket"
    expected_pack: "cloud.aws"
    expected_decision: "allow"
    reason: "List bucket contents"
  - command: "aws ec2 terminate-instances --instance-ids i-1234567890abcdef0"
    expected_pack: "cloud.aws"
    expected_decision: "deny"
    reason: "Terminate instances permanently destroys EC2 resources"
  - command: "aws rds delete-db-instance --db-instance-identifier prod-db"
    expected_pack: "cloud.aws"
    expected_decision: "deny"
    reason: "Delete DB instance permanently destroys the database"
  - command: "aws s3 rm s3://prod-bucket --recursive"
    expected_pack: "cloud.aws"
    expected_decision: "deny"
    reason: "Recursive rm deletes all objects in the bucket"
  - command: "aws cloudformation delete-stack --stack-name prod-stack"
    expected_pack: "cloud.aws"
    expected_decision: "deny"
    reason: "Delete stack removes infrastructure resources"
