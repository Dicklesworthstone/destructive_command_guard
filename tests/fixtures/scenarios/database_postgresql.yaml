# Scenario fixture for PostgreSQL maintenance and destructive SQL.
# Schema: id, description, steps[{command, expected_pack, expected_decision, reason}]

id: "database.postgresql.maintenance"
description: "Database maintenance with safe reads and destructive SQL mistakes."
steps:
  - command: "psql -c \"SELECT * FROM users LIMIT 10;\""
    expected_pack: "database.postgresql"
    expected_decision: "allow"
    reason: "Read-only query"
  - command: "pg_dump production > backup.sql"
    expected_pack: "database.postgresql"
    expected_decision: "allow"
    reason: "Backup without --clean"
  - command: "psql -c \"TRUNCATE TABLE sessions;\""
    expected_pack: "database.postgresql"
    expected_decision: "deny"
    reason: "TRUNCATE permanently deletes rows"
  - command: "psql -c \"DELETE FROM audit_log;\""
    expected_pack: "database.postgresql"
    expected_decision: "deny"
    reason: "DELETE without WHERE removes all rows"
  - command: "psql -c \"DROP DATABASE production;\""
    expected_pack: "database.postgresql"
    expected_decision: "deny"
    reason: "DROP DATABASE is destructive"
  - command: "dropdb production"
    expected_pack: "database.postgresql"
    expected_decision: "deny"
    reason: "dropdb permanently deletes the database"
