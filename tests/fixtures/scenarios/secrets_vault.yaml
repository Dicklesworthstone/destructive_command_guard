# Scenario fixture for Vault secrets management.
# Schema: id, description, steps[{command, expected_pack, expected_decision, reason}]

id: "secrets.vault.disable_engine"
description: "Operator inspects secrets but accidentally disables the secrets engine."
steps:
  - command: "vault status"
    expected_pack: "secrets.vault"
    expected_decision: "allow"
    reason: "Status check is read-only"
  - command: "vault secrets list"
    expected_pack: "secrets.vault"
    expected_decision: "allow"
    reason: "List secrets engines"
  - command: "vault kv get secret/app/config"
    expected_pack: "secrets.vault"
    expected_decision: "allow"
    reason: "Read secret value"
  - command: "vault kv put secret/app/config key=newvalue"
    expected_pack: "secrets.vault"
    expected_decision: "allow"
    reason: "Write/update secret value"
  - command: "vault secrets disable production-secrets"
    expected_pack: "secrets.vault"
    expected_decision: "deny"
    reason: "Disables the secrets engine and breaks access"
  - command: "vault secrets disable -f production-secrets"
    expected_pack: "secrets.vault"
    expected_decision: "deny"
    reason: "Force disable still removes access to secrets"
  - command: "vault kv destroy secret/app/config"
    expected_pack: "secrets.vault"
    expected_decision: "deny"
    reason: "Permanently destroys secret versions"
