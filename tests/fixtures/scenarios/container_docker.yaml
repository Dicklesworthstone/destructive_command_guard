# Scenario fixture for Docker operations.
# Schema: id, description, steps[{command, expected_pack, expected_decision, reason}]

id: "containers.docker.cleanup"
description: "Container inspection followed by destructive cleanup commands."
steps:
  - command: "docker ps"
    expected_pack: "containers.docker"
    expected_decision: "allow"
    reason: "List running containers"
  - command: "docker images"
    expected_pack: "containers.docker"
    expected_decision: "allow"
    reason: "List images"
  - command: "docker build -t myapp:latest ."
    expected_pack: "containers.docker"
    expected_decision: "allow"
    reason: "Build an image"
  - command: "docker system prune -af"
    expected_pack: "containers.docker"
    expected_decision: "deny"
    reason: "Prunes unused containers, images, networks, and build cache"
  - command: "docker volume rm app_data"
    expected_pack: "containers.docker"
    expected_decision: "deny"
    reason: "Deletes volume data"
  - command: "docker rm -f $(docker ps -aq)"
    expected_pack: "containers.docker"
    expected_decision: "deny"
    reason: "Force-removes containers"
