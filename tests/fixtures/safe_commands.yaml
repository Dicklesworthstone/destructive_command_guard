# Safe command fixtures for pack tests.
# Schema: { <pack_id>: [ { command: <string> } ] }
secrets.vault:
  - command: "vault status"
  - command: "vault read secret/myapp/config"
  - command: "vault kv get secret/myapp/config"
  - command: "vault kv list secret/"
  - command: "vault secrets list"
  - command: "vault policy list"
  - command: "vault token lookup"
  - command: "vault auth list"
  - command: "vault audit list"
  - command: "vault lease lookup lease_id"

secrets.aws_secrets:
  - command: "aws secretsmanager get-secret-value --secret-id my/secret"
  - command: "aws secretsmanager describe-secret --secret-id my/secret"
  - command: "aws secretsmanager list-secrets"
  - command: "aws secretsmanager list-secret-version-ids --secret-id my/secret"
  - command: "aws secretsmanager get-resource-policy --secret-id my/secret"
  - command: "aws secretsmanager get-secret-value --secret-id my/secret --version-id 1234"
  - command: "aws secretsmanager get-secret-value --secret-id my/secret --version-stage AWSCURRENT"
  - command: "aws secretsmanager get-random-password --password-length 32"
  - command: "aws secretsmanager describe-secret --secret-id arn:aws:secretsmanager:us-east-1:123456789012:secret:prod/db"
  - command: "aws secretsmanager list-secret-version-ids --secret-id my/secret --max-results 10"

secrets.onepassword:
  - command: "op whoami"
  - command: "op item get \"Database Password\""
  - command: "op item get 4f3b2c"
  - command: "op item list"
  - command: "op item list --vault Engineering"
  - command: "op document get \"Prod Cert\""
  - command: "op vault list"
  - command: "op vault get Engineering"
  - command: "op user list"
  - command: "op group list"

secrets.doppler:
  - command: "doppler secrets get DATABASE_URL"
  - command: "doppler secrets list"
  - command: "doppler secrets list --project backend --config prod"
  - command: "doppler secrets download --no-file --format json"
  - command: "doppler configs list"
  - command: "doppler configs list --project backend"
  - command: "doppler projects list"
  - command: "doppler login --token dp.example"
  - command: "doppler setup --project backend --config prod"
  - command: "doppler run -- printenv DATABASE_URL"

backup.rclone:
  - command: "rclone copy /src remote:important-bucket"
  - command: "rclone lsd remote:"
  - command: "rclone ls remote:important-bucket"
  - command: "rclone sync /src remote:important-bucket --dry-run"
  - command: "rclone md5sum remote:important-bucket"
  - command: "rclone check /src remote:important-bucket"
  - command: "rclone size remote:important-bucket"
  - command: "rclone lsjson remote:important-bucket"
  - command: "rclone about remote:"
  - command: "rclone cat remote:important-bucket/file.txt"

backup.restic:
  - command: "restic snapshots"
  - command: "restic backup /srv/data"
  - command: "restic check"
  - command: "restic stats"
  - command: "restic ls latest"
  - command: "restic find snapshot:abcd1234"
  - command: "restic dump latest /etc/hosts"
  - command: "restic mount /mnt/restic"
  - command: "restic unlock"
  - command: "restic version"

backup.borg:
  - command: "borg list repo"
  - command: "borg info repo"
  - command: "borg create repo::archive /srv/data"
  - command: "borg info repo::archive"
  - command: "borg list repo::archive"
  - command: "borg diff repo::archive1 repo::archive2"
  - command: "borg extract --dry-run repo::archive"
  - command: "borg mount repo::archive /mnt/borg"
  - command: "borg check repo"
  - command: "borg version"

backup.velero:
  - command: "velero backup get"
  - command: "velero backup describe daily-backup"
  - command: "velero backup logs daily-backup"
  - command: "velero schedule get"
  - command: "velero restore get"
  - command: "velero restore describe restore-2025-01-01"
  - command: "velero plugin get"
  - command: "velero snapshot get"
  - command: "velero version"
  - command: "velero get backups"

remote.rsync:
  - command: "rsync -a /src/ /dest/"
  - command: "rsync -a --progress /src/ /dest/"
  - command: "rsync -a --checksum /src/ /dest/"
  - command: "rsync -a --exclude 'tmp/' /src/ /dest/"
  - command: "rsync -n -a /src/ /dest/"
  - command: "rsync -a --list-only user@host:/dest/"
  - command: "rsync -a --stats /src/ /dest/"
  - command: "rsync -a --compress /src/ /dest/"
  - command: "rsync -a --partial --progress /src/ /dest/"
  - command: "rsync -a --info=progress2 /src/ /dest/"

storage.s3:
  - command: "aws s3 ls s3://my-bucket"
  - command: "aws s3 ls s3://my-bucket/path"
  - command: "aws s3 cp /tmp/file.txt s3://my-bucket/"
  - command: "aws s3 sync /src s3://my-bucket --dryrun"
  - command: "aws s3api list-buckets"
  - command: "aws s3api list-objects-v2 --bucket my-bucket"
  - command: "aws s3api head-object --bucket my-bucket --key path/file.txt"
  - command: "aws s3api get-object --bucket my-bucket --key path/file.txt /tmp/file.txt"
  - command: "aws s3api get-bucket-versioning --bucket my-bucket"
  - command: "aws s3api get-bucket-tagging --bucket my-bucket"

search.elasticsearch:
  - command: "curl -X GET 'http://localhost:9200/_cluster/health'"
  - command: "curl -X GET 'http://localhost:9200/_cat/indices?v'"
  - command: "curl -X GET 'http://localhost:9200/logs-2024/_search?q=error'"
  - command: "curl -X POST 'http://localhost:9200/logs-2024/_search' -H 'Content-Type: application/json' -d '{"\"query\"":{"\"match_all\"":{}}}'"
  - command: "curl -X GET 'http://localhost:9200/logs-2024/_mapping'"
  - command: "curl -X GET 'http://localhost:9200/_nodes'"
  - command: "curl -X GET 'http://localhost:9200/_settings'"
  - command: "curl -X GET 'http://localhost:9200/_aliases'"
  - command: "curl -X GET 'http://localhost:9200/_cat/shards?v'"
  - command: "curl -X GET 'http://localhost:9200/_cluster/stats'"

search.opensearch:
  - command: "curl -X GET 'https://opensearch.local:9200/_cluster/health'"
  - command: "curl -X GET 'https://opensearch.local:9200/_cat/indices?v'"
  - command: "curl -X GET 'https://opensearch.local:9200/logs-2024/_search?q=error'"
  - command: "curl -X POST 'https://opensearch.local:9200/logs-2024/_search' -H 'Content-Type: application/json' -d '{"\"query\"":{"\"match_all\"":{}}}'"
  - command: "curl -X GET 'https://opensearch.local:9200/logs-2024/_mapping'"
  - command: "curl -X GET 'https://opensearch.local:9200/_nodes'"
  - command: "curl -X GET 'https://opensearch.local:9200/_settings'"
  - command: "curl -X GET 'https://opensearch.local:9200/_aliases'"
  - command: "curl -X GET 'https://opensearch.local:9200/_cat/shards?v'"
  - command: "curl -X GET 'https://opensearch.local:9200/_cluster/stats'"

search.meilisearch:
  - command: "curl -X GET 'http://localhost:7700/health'"
  - command: "curl -X GET 'http://localhost:7700/version'"
  - command: "curl -X GET 'http://localhost:7700/indexes'"
  - command: "curl -X GET 'http://localhost:7700/indexes/movies/stats'"
  - command: "curl -X GET 'http://localhost:7700/indexes/movies/settings'"
  - command: "curl -X POST 'http://localhost:7700/indexes/movies/search' -H 'Content-Type: application/json' -d '{"\"q\"":"\"star\""}'"
  - command: "curl -X GET 'http://localhost:7700/tasks'"
  - command: "curl -X GET 'http://localhost:7700/keys'"
  - command: "curl -X GET 'http://localhost:7700/indexes/movies/documents'"
  - command: "curl -X GET 'http://localhost:7700/indexes/movies/documents/1'"

search.algolia:
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/indexes'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/indexes/products'"
  - command: "curl -X POST 'https://APPID-dsn.algolia.net/1/indexes/products/query' -H 'Content-Type: application/json' -d '{"\"params\"":"\"query=phone\""}'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/indexes/users'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/indexes/orders'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/logs'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/keys'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/indices/metadata'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/keys/abcdef'"
  - command: "curl -X GET 'https://APPID-dsn.algolia.net/1/usage'"

messaging.kafka:
  - command: "kafka-topics --bootstrap-server localhost:9092 --list"
  - command: "kafka-topics --bootstrap-server localhost:9092 --describe"
  - command: "kafka-consumer-groups --bootstrap-server localhost:9092 --list"
  - command: "kafka-consumer-groups --bootstrap-server localhost:9092 --describe --group billing"
  - command: "kafka-acls --bootstrap-server localhost:9092 --list"
  - command: "kafka-configs --bootstrap-server localhost:9092 --describe --entity-type topics --entity-name logs"
  - command: "kafka-topics --bootstrap-server localhost:9092 --create --topic new-topic --partitions 3 --replication-factor 1"
  - command: "kafka-topics --bootstrap-server localhost:9092 --describe --topic logs"
  - command: "kafka-consumer-groups --bootstrap-server localhost:9092 --describe --group analytics"
  - command: "kafka-broker-api-versions --bootstrap-server localhost:9092"

messaging.rabbitmq:
  - command: "rabbitmqctl list_users"
  - command: "rabbitmqctl list_vhosts"
  - command: "rabbitmqctl list_queues"
  - command: "rabbitmqctl list_exchanges"
  - command: "rabbitmqctl list_bindings"
  - command: "rabbitmqctl cluster_status"
  - command: "rabbitmqctl status"
  - command: "rabbitmq-diagnostics ping"
  - command: "rabbitmqadmin list queues"
  - command: "rabbitmqadmin list exchanges"

messaging.nats:
  - command: "nats stream list"
  - command: "nats stream info ORDERS"
  - command: "nats consumer list ORDERS"
  - command: "nats consumer info ORDERS CONSUMER1"
  - command: "nats kv ls CONFIG"
  - command: "nats kv get CONFIG api-key"
  - command: "nats bucket list"
  - command: "nats server list"
  - command: "nats account info"
  - command: "nats context ls"

messaging.sqs_sns:
  - command: "aws sqs list-queues"
  - command: "aws sqs get-queue-attributes --queue-url https://sqs.us-east-1.amazonaws.com/123456789012/my-queue --attribute-names All"
  - command: "aws sqs get-queue-url --queue-name my-queue"
  - command: "aws sqs list-dead-letter-source-queues --queue-url https://sqs.us-east-1.amazonaws.com/123456789012/my-queue"
  - command: "aws sns list-topics"
  - command: "aws sns list-subscriptions"
  - command: "aws sns get-topic-attributes --topic-arn arn:aws:sns:us-east-1:123456789012:alerts"
  - command: "aws sns list-subscriptions-by-topic --topic-arn arn:aws:sns:us-east-1:123456789012:alerts"
  - command: "aws sqs receive-message --queue-url https://sqs.us-east-1.amazonaws.com/123456789012/my-queue --max-number-of-messages 1"
  - command: "aws sqs get-queue-attributes --queue-url https://sqs.us-east-1.amazonaws.com/123456789012/critical --attribute-names ApproximateNumberOfMessages"

cicd.jenkins:
  - command: "java -jar jenkins-cli.jar -s http://jenkins.local/ list-jobs"
  - command: "java -jar jenkins-cli.jar -s http://jenkins.local/ who-am-i"
  - command: "java -jar jenkins-cli.jar -s http://jenkins.local/ get-job deploy-prod"
  - command: "java -jar jenkins-cli.jar -s http://jenkins.local/ list-views"
  - command: "java -jar jenkins-cli.jar -s http://jenkins.local/ list-plugins"
  - command: "java -jar jenkins-cli.jar -s http://jenkins.local/ get-node agent-1"
  - command: "java -jar jenkins-cli.jar -s http://jenkins.local/ get-credentials system::system::jenkins"
  - command: "curl -X GET http://jenkins.local/api/json"
  - command: "curl -X GET http://jenkins.local/job/deploy-prod/api/json"
  - command: "curl -X GET http://jenkins.local/credentials/store/system/domain/_/api/json"

cicd.gitlab_ci:
  - command: "gitlab-runner list"
  - command: "gitlab-runner status"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/pipelines'"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/pipelines/1001'"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/jobs'"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/jobs/5001'"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/environments'"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/environments/15'"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/variables'"
  - command: "curl -X GET 'https://gitlab.example.com/api/v4/projects/42/registry/repositories'"

cicd.circleci:
  - command: "circleci context list org/my-org"
  - command: "circleci context list --org-slug org/my-org"
  - command: "circleci orb list org/my-org"
  - command: "circleci orb info my-org/my-orb"
  - command: "circleci pipeline list org/my-org/project/app"
  - command: "circleci project list"
  - command: "circleci namespace list"
  - command: "circleci config validate .circleci/config.yml"
  - command: "circleci policy status"
  - command: "circleci diagnostic"
